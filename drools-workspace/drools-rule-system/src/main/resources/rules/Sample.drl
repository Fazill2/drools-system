package com.soda.rules

import com.soda.helper.SodaUI
import javax.swing.*;


declare Question
	questionText : String = null;
	possibleAnswers : String[] = null;
	answer : String = null;
end

rule "init"
when
	sodaUI : SodaUI()
then
	Question mexicoQuestion = new Question();
	mexicoQuestion.setQuestionText("Are you in mexico?");
	String[] answers = {"Yes", "No"};
	mexicoQuestion.setPossibleAnswers(answers);
	insert(mexicoQuestion);
	System.out.println("init");
end



rule "Are you in mexico?"
when
    q : Question(questionText == "Are you in mexico?", answer == null)
    sodaUI: SodaUI();
then
    showQuestion(q, sodaUI);
    System.out.println("Are you in mexico?");
    update(q);
end

rule "Are you in mexico? No"
when
    q : Question(questionText == "Are you in mexico?", answer == "No")
    sodaUI: SodaUI()
then
	Question noobQuestion = new Question();
	noobQuestion.setQuestionText("Do you PwN nOoBs?");
	String[] answers = {"Yes", "No"};
	noobQuestion.setPossibleAnswers(answers);
	insert(noobQuestion);
end

rule "Are you in mexico? Yes"
when
    q : Question(questionText == "Are you in mexico?", answer == "Yes")
    sodaUI: SodaUI()
then
	// TODO: implement suggestions
	System.out.println("Show Suggestion");
end



rule "Do you PwN nOoBs?"
when
    q : Question(questionText == "Do you PwN nOoBs?", answer == null)
    mexicoQuestion : Question(questionText == "Are you in mexico?", answer == "No")
    sodaUI: SodaUI();
then
    showQuestion(q, sodaUI);
    System.out.println("Do you PwN nOoBs?");
    update(q);
end

rule "Do you PwN nOoBs? Yes"
when
    q : Question(questionText == "Do you PwN nOoBs?", answer == "Yes")
    sodaUi: SodaUI();
then
	// TODO: implement suggestions
	System.out.println("Show Suggestion");
end

rule "Do you PwN nOoBs? No"
when
    q : Question(questionText == "Do you PwN nOoBs?", answer == "No")
    sodaUI: SodaUI();
then
    Question dietQuestion = new Question();
	dietQuestion.setQuestionText("Are you on a diet?");
	String[] answers = {"Yes", "No"};
	dietQuestion.setPossibleAnswers(answers);
	insert(dietQuestion);
end


function void showQuestion(Question question, JFrame frame){
	int n = JOptionPane.showOptionDialog(frame,
                                             question.getQuestionText(),
                                             "",
                                             0,
                                             JOptionPane.QUESTION_MESSAGE,
                                             null,
                                             question.getPossibleAnswers(),
                                             question.getPossibleAnswers()[0]);
   question.setAnswer(question.getPossibleAnswers()[n]);
}

